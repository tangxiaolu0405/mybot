---
name: memory-iteration-manager
description: 管理CLAW项目的记忆迭代过程，包括信息提炼、记忆更新、流转规则执行和关联建立。负责在任务完成后自动执行记忆系统的迭代优化。
version: 1.0.0
author: CLAW Team
tags: [memory, iteration, knowledge-management, self-improvement]
dependencies: [memory-reader]
---

# Memory Iteration Manager

## 功能描述

管理CLAW项目的记忆迭代过程，包括信息提炼、记忆更新、流转规则执行和关联建立。在任务完成后自动执行记忆系统的迭代优化，确保记忆系统的持续进化和价值提升。

## 使用场景

- 任务完成后需要更新记忆
- 需要将短期记忆提升到长期记忆
- 需要建立记忆之间的关联关系
- 需要执行记忆流转规则
- 需要提炼和总结经验教训
- 需要清理和优化记忆系统

## 指令说明

### 基础指令

- **执行记忆迭代**：执行完整的记忆迭代流程
- **提炼关键信息**：从任务执行中提取关键知识点
- **更新短期记忆**：更新当前会话的短期记忆
- **评估记忆提升**：评估记忆是否需要提升到长期记忆
- **建立记忆关联**：建立记忆之间的关联关系

### 高级指令

- **批量记忆迭代**：对多个任务结果进行批量迭代
- **深度记忆分析**：深入分析记忆的价值和关联
- **记忆清理优化**：清理低价值记忆，优化记忆结构
- **记忆质量评估**：评估记忆系统的整体质量

## 记忆分类规则（按优先级）

1. **显式标记** → 按标记分类
2. **会话相关** → 短期记忆
3. **需持久化** → 长期记忆
4. **任务相关** → 工作记忆
5. **可复用** → 长期记忆

## 记忆流转规则

### 提升到长期记忆

满足以下任一条件：
- 访问次数 > 5次
- 存在时间 > 1小时
- 重要性权重 > 0.7
- 包含关键知识或最佳实践
- 用户明确标记为重要

### 降级或删除

满足以下任一条件：
- 30天未访问
- 重要性权重持续下降
- 已被新的记忆替代
- 证明为错误或过时的信息

## 记忆迭代流程

### 阶段1：信息提炼

1. **提取关键信息**
   - 识别任务中的关键决策点
   - 提取成功的解决方案
   - 总结失败的教训

2. **识别模式**
   - 识别重复出现的问题模式
   - 提取可复用的解决方案
   - 总结最佳实践

3. **评估价值**
   - 评估信息的长期价值
   - 计算重要性权重
   - 标记关键知识点

### 阶段2：记忆更新

1. **更新短期记忆**
   - 记录任务执行过程
   - 记录任务结果和用户反馈
   - 更新会话上下文和状态

2. **评估长期记忆提升**
   - 检查提升条件
   - 计算访问频率和时效性
   - 评估重要性和可复用性

3. **执行记忆提升**
   - 将高价值信息提升到长期记忆
   - 更新长期记忆的访问统计
   - 调整重要性权重

### 阶段3：记忆关联

1. **提取关键词**
   - 从记忆内容中提取关键词
   - 识别技术术语和概念
   - 提取领域特定词汇

2. **搜索相似记忆**
   - 基于关键词搜索相似记忆
   - 识别潜在的关联关系
   - 发现重复或冲突的信息

3. **建立关联**
   - 建立记忆之间的关联关系
   - 解决冲突和重复
   - 构建记忆网络

### 阶段4：记忆优化

1. **清理低价值记忆**
   - 识别长期未访问的记忆
   - 评估记忆的当前价值
   - 删除或归档低价值记忆

2. **优化记忆结构**
   - 重新组织记忆分类
   - 优化记忆索引
   - 改进记忆检索效率

3. **更新记忆统计**
   - 更新访问频率
   - 更新重要性权重
   - 记录成功/失败统计

## 记忆操作

### 检索
- 从长期记忆检索类似问题的解决方案
- 从工作记忆加载当前任务上下文
- 从短期记忆提取会话相关信息
- 检索用户历史偏好和决策模式

### 关联
- 提取关键词，建立关联
- 解决冲突和重复
- 构建记忆网络

### 提炼
- 识别模式，提取规则
- 总结实践，分析错误
- 归档方案，提炼知识

### 更新
- 实时更新访问频率
- 调整重要性权重
- 记录成功/失败统计

## 记忆类型

### 长期记忆
- **项目知识**：项目架构、技术栈、设计模式
- **代码模式**：最佳实践、常见模式、反模式
- **用户偏好**：代码风格、工作习惯、决策偏好
- **技术栈**：使用的框架、库、工具
- **历史决策**：重要的架构决策、技术选型
- **经验教训**：成功案例、失败教训

### 短期记忆
- **当前会话**：会话ID、开始时间、用户意图
- **任务队列**：进行中、待处理的任务
- **上下文信息**：项目状态、用户偏好
- **临时变量**：配置参数、路径信息
- **中间结果**：已完成任务、生成内容
- **会话历史**：用户请求、系统响应

### 工作记忆
- **当前任务**：任务描述、目标、状态
- **执行上下文**：相关记忆、技能、工具
- **临时数据**：中间结果、计算值
- **决策记录**：关键决策和理由

## 最佳实践

- 任务完成后立即执行记忆迭代
- 优先提升高价值信息到长期记忆
- 建立强关联以提高记忆命中率
- 定期清理低价值记忆
- 保持记忆的时效性和准确性
- 遵循记忆流转规则

## 注意事项

- 记忆提升需要满足流转条件
- 关联建立需要基于关键词匹配
- 记忆删除需要谨慎评估
- 保护用户隐私和敏感信息
- 避免记忆过度膨胀
- 保持记忆系统的性能
